-- TRIZ AIMBOT v4.3 
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local Camera = Workspace.CurrentCamera
local Replicated = game:GetService("ReplicatedStorage")
local UserInputService = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")


local LOCAL_PLAYER = Players.LocalPlayer
local ACTIVATION_KEY = "TrizImba" 
local Activated = false

local CircleRadius = 170
local BulletSpeed = 2200
local TargetPlayer = nil
local RightMouseButtonHeld = false
local AimingEnabled = true
local CircleVisible = true


local function CreateActivationGUI()
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "TrizAimbotAuth"
    ScreenGui.Parent = CoreGui

    local MainFrame = Instance.new("Frame")
    MainFrame.Size = UDim2.new(0, 350, 0, 200)
    MainFrame.Position = UDim2.new(0.5, -175, 0.5, -100)
    MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
    MainFrame.BorderSizePixel = 0
    MainFrame.Parent = ScreenGui

    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 12)
    UICorner.Parent = MainFrame

    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Text = "TRIZ AIMBOT PRO"
    TitleLabel.TextColor3 = Color3.fromRGB(170, 170, 200)
    TitleLabel.Font = Enum.Font.GothamBold
    TitleLabel.TextSize = 22
    TitleLabel.Size = UDim2.new(1, 0, 0, 40)
    TitleLabel.BackgroundTransparency = 1
    TitleLabel.Parent = MainFrame

    local InputBox = Instance.new("TextBox")
    InputBox.PlaceholderText = "Введите ключ активации..."
    InputBox.Size = UDim2.new(0, 310, 0, 40)
    InputBox.Position = UDim2.new(0.5, -155, 0.3, 0)
    InputBox.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
    InputBox.TextColor3 = Color3.fromRGB(200, 200, 210)
    InputBox.Font = Enum.Font.GothamMedium
    InputBox.TextSize = 16
    InputBox.Parent = MainFrame

    local InputCorner = Instance.new("UICorner")
    InputCorner.CornerRadius = UDim.new(0, 8)
    InputCorner.Parent = InputBox

    local StatusLabel = Instance.new("TextLabel")
    StatusLabel.Text = "Статус: Ожидание ключа..."
    StatusLabel.TextColor3 = Color3.fromRGB(140, 140, 160)
    StatusLabel.Font = Enum.Font.Gotham
    StatusLabel.TextSize = 14
    StatusLabel.Size = UDim2.new(1, 0, 0, 30)
    StatusLabel.Position = UDim2.new(0, 0, 0.85, 0)
    StatusLabel.BackgroundTransparency = 1
    StatusLabel.Parent = MainFrame

    InputBox.FocusLost:Connect(function(enterPressed)
        if enterPressed then
            if InputBox.Text == ACTIVATION_KEY then
                Activated = true
                StatusLabel.Text = "✅ Активация успешна!"
                StatusLabel.TextColor3 = Color3.fromRGB(80, 255, 80)
                wait(1.5)
                ScreenGui:Destroy()
            else
                StatusLabel.Text = "❌ Неверный ключ!"
                StatusLabel.TextColor3 = Color3.fromRGB(255, 80, 80)
                InputBox.Text = ""
            end
        end
    end)
end

local function InitAimbot()
    local Circle = Drawing.new("Circle")
    Circle.Visible = CircleVisible
    Circle.Color = Color3.fromRGB(107, 98, 155)
    Circle.Thickness = 2
    Circle.Radius = CircleRadius
    Circle.Filled = false

    local viewportSize = Camera.ViewportSize
    Circle.Position = Vector2.new(viewportSize.X / 2, viewportSize.Y / 2)

    local function getBulletSpeed()
        local character = LOCAL_PLAYER.Character
        if character then
            local gun = character:FindFirstChild("CurrentSelectedObject")
            if gun and gun.Value then
                local weaponData = Replicated:FindFirstChild("GunData"):FindFirstChild(gun.Value.Value.Name)
                return weaponData and weaponData.Stats.BulletSettings.BulletSpeed.Value or 2200
            end
        end
        return 2200
    end

    local function predictPosition(targetPosition, targetVelocity)
        local distance = (targetPosition - Camera.CFrame.Position).Magnitude
        if distance < 1 then return targetPosition end
        local travelTime = distance / BulletSpeed
        return targetPosition + targetVelocity * travelTime * 1.054 + Vector3.new(0, 50 * travelTime^2 * 1.052, 0)
    end

    local function aimAtTarget()
        if not TargetPlayer or not TargetPlayer.Character then return end
        local rootPart = TargetPlayer.Character:FindFirstChild("ServerColliderHead")
        if rootPart and rootPart:IsA("BasePart") then
            local futurePos = predictPosition(rootPart.Position, rootPart.Velocity)
            local screenPoint = Camera:WorldToViewportPoint(futurePos)
            
            if screenPoint.Z > 0 then
                local deltaX = screenPoint.X - (viewportSize.X / 2)
                local deltaY = screenPoint.Y - (viewportSize.Y / 2)
                mousemoverel(deltaX, deltaY)
            end
        end
    end


    UserInputService.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton2 then
            RightMouseButtonHeld = true
        elseif input.KeyCode == Enum.KeyCode.F2 then
            AimingEnabled = not AimingEnabled
            CircleVisible = not CircleVisible
            Circle.Visible = CircleVisible
            TargetPlayer = nil
        end
    end)

    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton2 then
            RightMouseButtonHeld = false
            TargetPlayer = nil
        end
    end)

    RunService.RenderStepped:Connect(function()
        if not Activated then return end -- Аимбот не работает без активации

        viewportSize = Camera.ViewportSize
        Circle.Position = Vector2.new(viewportSize.X / 2, viewportSize.Y / 2)
        Circle.Radius = CircleRadius
        BulletSpeed = getBulletSpeed()
        
        if RightMouseButtonHeld and AimingEnabled and CircleVisible then
            local closestDistance = math.huge
            local currentTarget = nil
            
            for _, player in pairs(Players:GetPlayers()) do
                if player ~= LOCAL_PLAYER and player.Character then
                    local rootPart = player.Character:FindFirstChild("ServerColliderHead")
                    if rootPart and rootPart:IsA("BasePart") then
                        local screenPos = Camera:WorldToViewportPoint(rootPart.Position)
                        
                        if screenPos.Z > 0 then
                            local center = Vector2.new(viewportSize.X / 2, viewportSize.Y / 2)
                            local distance = (Vector2.new(screenPos.X, screenPos.Y) - center).Magnitude
                            
                            if distance < CircleRadius and distance < closestDistance then
                                closestDistance = distance
                                currentTarget = player
                            end
                        end
                    end
                end
            end
            
            TargetPlayer = currentTarget
            aimAtTarget()
        else
            TargetPlayer = nil
        end
    end)
end

CreateActivationGUI()
InitAimbot()
